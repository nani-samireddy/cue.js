!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Cue=e()}(this,(function(){"use strict";class t{constructor(t={}){this.options={overlay:!0,overlayClickExits:!0,showProgress:!1,showBullets:!1,showButtons:!0,keyboardNavigation:!0,nextLabel:"Next",prevLabel:"Back",skipLabel:"Skip",doneLabel:"Done",scrollToElement:!0,exitOnEsc:!0,exitOnOverlayClick:!0,debug:!1,tooltipPosition:"auto",padding:10,buttonClass:"",highlightClass:"",tooltipClass:"",transitionDuration:300,...t},this.steps=[],this.currentStepIndex=-1,this.isTourActive=!1,this.elements={overlay:null,highlight:null,tooltip:null},this.callbacks={onStart:[],onBeforeChange:[],onChange:[],onAfterChange:[],onExit:[],onComplete:[],onResize:[]},this._eventHandlers={},this._setupEventListeners()}setSteps(t){return this.steps=t.filter((t=>t.target)).map((t=>({...t,_targetElement:"string"==typeof t.target?document.querySelector(t.target):t.target}))),this}start(t=0){this.isTourActive&&(this._log("Tour already active, exiting current and restarting."),this.exit()),this.steps&&0!==this.steps.length?(this.isTourActive=!0,this.currentStepIndex=t,this._triggerCallbacks("onStart"),this._showStep(this.currentStepIndex)):console.warn("Cue.js: No steps defined. Call setSteps() first.")}goToStep(t){this.isTourActive?t<0||t>=this.steps.length?console.warn(`Cue.js: Step index ${t} is out of bounds.`):this._showStep(t):this._log("Tour not active. Call start() first.")}nextStep(){this.currentStepIndex<this.steps.length-1?this._showStep(this.currentStepIndex+1):(this.exit(),this._triggerCallbacks("onComplete"))}prevStep(){this.currentStepIndex>0&&this._showStep(this.currentStepIndex-1)}exit(){this.isTourActive&&(this.isTourActive=!1,this._cleanupElements(!1,this.currentStepIndex),this._triggerCallbacks("onExit",this.currentStepIndex),this.currentStepIndex=-1,this._log("Tour exited."))}refresh(){this.isTourActive&&-1!==this.currentStepIndex&&this._positionElements()}onStart(t){return this.callbacks.onStart.push(t),this}onBeforeChange(t){return this.callbacks.onBeforeChange.push(t),this}onChange(t){return this.callbacks.onChange.push(t),this}onAfterChange(t){return this.callbacks.onAfterChange.push(t),this}onExit(t){return this.callbacks.onExit.push(t),this}onComplete(t){return this.callbacks.onComplete.push(t),this}onResize(t){return this.callbacks.onResize.push(t),this}getCurrentStep(){return this.steps[this.currentStepIndex]||null}getCurrentStepIndex(){return this.currentStepIndex}_log(...t){this.options.debug&&console.log("%cCue.js:","color: #7B68EE; font-weight: bold;",...t)}_getStepOptions(t){const e=this.steps[t];return e?{target:e.target,_targetElement:e._targetElement,title:e.title||"",content:e.content||"",position:e.position||this.options.tooltipPosition,highlightClass:e.highlightClass||this.options.highlightClass,tooltipClass:e.tooltipClass||this.options.tooltipClass,padding:"number"==typeof e.padding?e.padding:this.options.padding,scrollToElement:"boolean"==typeof e.scrollToElement?e.scrollToElement:this.options.scrollToElement,disableInteraction:"boolean"==typeof e.disableInteraction&&e.disableInteraction,showButtons:"boolean"==typeof e.showButtons?e.showButtons:this.options.showButtons,...e}:null}async _showStep(t){const e=this.currentStepIndex,s=this._getStepOptions(t);if(!s)return void this.exit();const i="string"==typeof s.target?document.querySelector(s.target):s._targetElement;if(i)"function"==typeof s.preStep&&await Promise.resolve(s.preStep(s)),this._triggerCallbacks("onBeforeChange",s,t),this.currentStepIndex=t,this._cleanupElements(!0,e),this._createElements(i,s),this._positionElements(),this.elements.overlay&&this.elements.overlay.classList.add("active"),this.elements.highlight&&this.elements.highlight.classList.add("active"),this.elements.tooltip&&this.elements.tooltip.classList.add("active"),s.disableInteraction?(this.elements.highlight&&(this.elements.highlight.style.pointerEvents="none"),i.style.pointerEvents="none"):(this.elements.highlight&&(this.elements.highlight.style.pointerEvents="none"),i.style.removeProperty("pointer-events")),s.scrollToElement&&i.scrollIntoView({behavior:"smooth",block:"center"}),this._triggerCallbacks("onChange",s,t),setTimeout((()=>{this._triggerCallbacks("onAfterChange",s,t)}),this.options.transitionDuration);else{if(console.warn(`Cue.js: Target element "${s.target}" not found for step ${t}.`),"function"==typeof s.onTargetNotFound){const e=await Promise.resolve(s.onTargetNotFound(s));if("skip"===e)return this._log(`Skipping step ${t} due to target not found.`),void this.nextStep();if("stop"===e)return this._log(`Stopping tour due to target not found for step ${t}.`),void this.exit()}this.exit()}}_createElements(t,e){const s=document.body;this.options.overlay&&(this.elements.overlay=document.createElement("div"),this.elements.overlay.className="cue-overlay",this.options.overlayClickExits&&(this._eventHandlers.overlayClick=()=>this.exit(),this.elements.overlay.addEventListener("click",this._eventHandlers.overlayClick)),s.appendChild(this.elements.overlay)),this.elements.highlight=document.createElement("div"),this.elements.highlight.className="cue-highlight",e.highlightClass&&this.elements.highlight.classList.add(e.highlightClass),s.appendChild(this.elements.highlight),this.elements.tooltip=document.createElement("div"),this.elements.tooltip.className="cue-tooltip",e.tooltipClass&&this.elements.tooltip.classList.add(e.tooltipClass);const i=e.title?`<div class="cue-tooltip-title">${e.title}</div>`:"",n=e.content?`<div class="cue-tooltip-content">${e.content}</div>`:"";let o="";this.options.showProgress&&this.steps.length>1&&(o=`<div class="cue-progress">Step ${this.currentStepIndex+1} of ${this.steps.length}</div>`);let l="";if(this.options.showBullets&&this.steps.length>1){l='<div class="cue-bullets">';for(let t=0;t<this.steps.length;t++)l+=`<span class="cue-bullet ${t===this.currentStepIndex?"active":""}" data-step-index="${t}"></span>`;l+="</div>"}let h="";if(e.showButtons){const t=0===this.currentStepIndex,e=this.currentStepIndex===this.steps.length-1,s=this.options.buttonClass?` ${this.options.buttonClass}`:"";h=`\n                <div class="cue-buttons">\n                    ${this.options.skipLabel?`<button class="cue-button cue-skip${s}"><span>${this.options.skipLabel}</span></button>`:""}\n                    ${!t&&this.options.prevLabel?`<button class="cue-button cue-prev${s}"><span>${this.options.prevLabel}</span></button>`:""}\n                    ${!e&&this.options.nextLabel?`<button class="cue-button cue-next${s}"><span>${this.options.nextLabel}</span></button>`:""}\n                    ${e&&this.options.doneLabel?`<button class="cue-button cue-done${s}"><span>${this.options.doneLabel}</span></button>`:""}\n                </div>\n            `}if(this.elements.tooltip.innerHTML=`\n            ${i}\n            ${n}\n            ${o}\n            ${l}\n            ${h}\n        `,s.appendChild(this.elements.tooltip),e.showButtons){const t=this.elements.tooltip.querySelector(".cue-skip");t&&(this._eventHandlers.skipClick=()=>this.exit(),t.addEventListener("click",this._eventHandlers.skipClick));const e=this.elements.tooltip.querySelector(".cue-prev");e&&(this._eventHandlers.prevClick=()=>this.prevStep(),e.addEventListener("click",this._eventHandlers.prevClick));const s=this.elements.tooltip.querySelector(".cue-next");s&&(this._eventHandlers.nextClick=()=>this.nextStep(),s.addEventListener("click",this._eventHandlers.nextClick));const i=this.elements.tooltip.querySelector(".cue-done");i&&(this._eventHandlers.doneClick=()=>{this.exit(),this._triggerCallbacks("onComplete")},i.addEventListener("click",this._eventHandlers.doneClick))}if(this.options.showBullets){const t=this.elements.tooltip.querySelector(".cue-bullets");t&&(this._eventHandlers.bulletClick=t=>{const e=t.target.closest(".cue-bullet");if(e){const t=parseInt(e.dataset.stepIndex);isNaN(t)||t===this.currentStepIndex||this.goToStep(t)}},t.addEventListener("click",this._eventHandlers.bulletClick))}}_positionElements(){if(!this.elements.highlight||!this.elements.tooltip)return;const t=this.steps[this.currentStepIndex],e="string"==typeof t.target?document.querySelector(t.target):t._targetElement;if(!e)return void this.exit();const s=e.getBoundingClientRect(),i="number"==typeof t.padding?t.padding:this.options.padding,n=t.position||this.options.tooltipPosition;this.elements.highlight.style.width=`${s.width+2*i}px`,this.elements.highlight.style.height=`${s.height+2*i}px`,this.elements.highlight.style.top=s.top+window.scrollY-i+"px",this.elements.highlight.style.left=s.left+window.scrollX-i+"px",this.elements.tooltip.style.top="",this.elements.tooltip.style.left="";const o=this.elements.tooltip.getBoundingClientRect(),l=window.innerWidth,h=window.innerHeight,{top:r,left:a}=(t=>{let e,i;const n=20;switch(t){case"top":e=s.top-o.height-n,i=s.left+s.width/2-o.width/2;break;case"bottom":e=s.bottom+n,i=s.left+s.width/2-o.width/2;break;case"left":e=s.top+s.height/2-o.height/2,i=s.left-o.width-n;break;case"right":e=s.top+s.height/2-o.height/2,i=s.right+n;break;case"center":e=h/2-o.height/2,i=l/2-o.width/2;break;default:e=s.bottom+n,i=s.left+s.width/2-o.width/2,e+o.height>h&&s.top-o.height-n>0&&(e=s.top-o.height-n),(i<0||i+o.width>l)&&(i=Math.max(10,l/2-o.width/2)),(e<0||e+o.height>h)&&s.right+n+o.width<l?(e=s.top+s.height/2-o.height/2,i=s.right+n):(e<0||e+o.height>h)&&s.left-o.width-n>0&&(e=s.top+s.height/2-o.height/2,i=s.left-o.width-n)}const r=10;return i+o.width>l-r&&(i=l-o.width-r),i<r&&(i=r),e+o.height>h-r&&(e=h-o.height-r),e<r&&(e=r),{top:e,left:i}})(n);this.elements.tooltip.style.top=`${r+window.scrollY}px`,this.elements.tooltip.style.left=`${a+window.scrollX}px`}_cleanupElements(t=!1,e=-1){if(this.elements.overlay&&this.elements.overlay.classList.remove("active"),this.elements.highlight&&this.elements.highlight.classList.remove("active"),this.elements.tooltip&&this.elements.tooltip.classList.remove("active"),this.elements.overlay&&this._eventHandlers.overlayClick&&this.elements.overlay.removeEventListener("click",this._eventHandlers.overlayClick),this.elements.tooltip){const t=this.elements.tooltip.querySelector(".cue-skip");t&&this._eventHandlers.skipClick&&t.removeEventListener("click",this._eventHandlers.skipClick);const e=this.elements.tooltip.querySelector(".cue-prev");e&&this._eventHandlers.prevClick&&e.removeEventListener("click",this._eventHandlers.prevClick);const s=this.elements.tooltip.querySelector(".cue-next");s&&this._eventHandlers.nextClick&&s.removeEventListener("click",this._eventHandlers.nextClick);const i=this.elements.tooltip.querySelector(".cue-done");i&&this._eventHandlers.doneClick&&i.removeEventListener("click",this._eventHandlers.doneClick);const n=this.elements.tooltip.querySelector(".cue-bullets");n&&this._eventHandlers.bulletClick&&n.removeEventListener("click",this._eventHandlers.bulletClick)}this._eventHandlers.skipClick=null,this._eventHandlers.prevClick=null,this._eventHandlers.nextClick=null,this._eventHandlers.doneClick=null,this._eventHandlers.bulletClick=null;const s=t?this.options.transitionDuration:0,i={...this.elements};if(setTimeout((()=>{Object.values(i).forEach((t=>{t&&t.parentNode&&t.parentNode.removeChild(t)}))}),s),this.elements={overlay:null,highlight:null,tooltip:null},-1!==e){const t=this._getStepOptions(e);if(t&&t.disableInteraction){const e="string"==typeof t.target?document.querySelector(t.target):t._targetElement;e&&e.style.removeProperty("pointer-events")}}}_setupEventListeners(){this._eventHandlers.keydown=t=>this._handleKeydown(t),document.addEventListener("keydown",this._eventHandlers.keydown),this._eventHandlers.resize=()=>{this.refresh(),this._triggerCallbacks("onResize")},window.addEventListener("resize",this._eventHandlers.resize)}_handleKeydown(t){this.isTourActive&&(this.options.exitOnEsc&&"Escape"===t.key?(t.preventDefault(),this.exit()):this.options.keyboardNavigation&&("ArrowRight"===t.key||" "===t.key?(t.preventDefault(),this.nextStep()):"ArrowLeft"===t.key&&(t.preventDefault(),this.prevStep())))}_triggerCallbacks(t,...e){this.callbacks[t].forEach((s=>{try{s(...e)}catch(e){console.error(`Cue.js: Error in '${t}' callback:`,e)}}))}}return document.addEventListener("DOMContentLoaded",(()=>{"undefined"!=typeof window&&(window.Cue=t)})),"undefined"!=typeof module&&module.exports&&(module.exports=t),t}));
//# sourceMappingURL=cue.min.js.map
